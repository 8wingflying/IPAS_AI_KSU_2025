# Diffusion model
- 基本觀念
  - https://ithelp.ithome.com.tw/articles/10329715
  - 【YOUTUBE 影片】[[專題解說] Introduction to Diffusion Model 擴散模型入門 [附程式碼] 教學](https://www.youtube.com/watch?v=dbQCzrWgLh0)
    - https://www.youtube.com/@gongginshih/videos 
- 數學推導
  - 👍👍【YOUTUBE 影片】[Diffusion Models: DDPM | Generative AI Animated](https://www.youtube.com/watch?v=EhndHhIvWWw)
  - [[論文導讀] Understanding Diffusion Models: A Unified Perspective 擴散模型的數學原理](https://www.youtube.com/watch?v=__NWtPdsfxA)
  - [Understanding Diffusion Models: A Unified Perspective](https://arxiv.org/abs/2208.11970)
- 歷史發展Diffussion Model(2015)  [【Diffusion介紹】一系列Diffusion經典論文介紹](https://www.youtube.com/watch?v=PkBxB6aoOkQ)
  - 2015 [Deep Unsupervised Learning using Nonequilibrium Thermodynamics](https://arxiv.org/abs/1503.03585)
  - 2019
  - 2020 | DDPM|denoising diffusion probabilistic model (很慢)
    - [【DDPM介紹】Diffusion開山之祖 - DDPM](https://www.youtube.com/watch?v=6qR-BapJn-g) 
  - 2020 | OpenAI | Denoising Diffusion Implicit Models (DDIM)
    - 2020 DDIM [Denoising diffusion implicit models](https://arxiv.org/abs/2010.02502)
    - [【DDIM介紹】換個推導方式大加速 - DDIM](https://www.youtube.com/watch?v=swUoNBpHRpY)
  - 2021 Score-Based Generative Models (SGMs)
    - 使用(Stein) score (a.k.a., score or score function)  而非 Fisher score
    - Y. Song and S. Ermon, “Score-based generative modeling through stochastic differential equations,” in ICLR, 2021.
    - perturb data with a sequence of intensifying Gaussian noise and jointly estimate the score functions for all noisy data distributions by training a deep neural network model conditioned on noise levels ==> noise-conditional score network, NCSN
    - Samples are generated by chaining the score functions at decreasing noise levels with score-based sampling approaches
      - Langevin Monte Carlo
      - stochastic differential equations
      - ordinary differential equations 
    - Training and sampling are completely decoupled in the formulation of score-based generative models, so one can use a multitude of sampling techniques after the estimation of score functions. 
  - 2021 | LDM | 潛在擴散模型| latent diffusion models
    - [[2112.10752] High-resolution image synthesis with latent diffusion models](https://arxiv.org/abs/2112.10752)
      - CVPR, pp. 10684–10695, 2022. 
  - 2022 | Stable Diffusion  ==> KerasCV
    - Stable Diffusion由3個部分組成：變分自編碼器（VAE）、U-Net和一個文字編碼器
    - 是一種潛在擴散模型
    - Stable Diffusion模型訓練使用的資料集:LAION-5B的圖片和標題對 LAION-Aesthetics v2 5+
    - 在亞馬遜雲端運算服務上使用256個NVIDIA A100 GPU訓練，共花費15萬個GPU小時，成本為60萬美元
    - https://zh.wikipedia.org/zh-tw/Stable_Diffusion
    - 文生圖功能 ==> "txt2img"==> 接受一個提示詞，以及包括採樣器（sampling type），圖像尺寸，和隨機種子的各種選項參數，並根據模型對提示的解釋生成一個圖像檔案。
    - 圖生圖功能 ==> "img2img"==> 接受一個提示詞、現有圖像的檔案路徑和0.0到1.0之間的去噪強度，並在原始圖像的基礎上產生一個新的圖像
    - https://gooptions.cc/stable-diffusion%E6%95%99%E5%AD%B8/
    - 版本 ==> see https://zh.wikipedia.org/zh-tw/Stable_Diffusion
      - Stable Diffusion 3.5(2024年10月)
  - Stable Diffusion模型權重 微調的方法
    - LoRA ==> PEFT(Parameter-Efficient Fine-Tuning) [𝓐𝔀𝓮𝓼𝓸𝓶𝓮 𝓟𝓪𝓻𝓪𝓶𝓮𝓽𝓮𝓻-𝓔𝓯𝓯𝓲𝓬𝓲𝓮𝓷𝓽 𝓣𝓻𝓪𝓷𝓼𝓯𝓮𝓻 𝓛𝓮𝓪𝓻𝓷𝓲𝓷𝓰](https://github.com/synbol/Awesome-Parameter-Efficient-Transfer-Learning)
      - [LoRA: Low-Rank Adaptation of Large Language Models](https://arxiv.org/abs/2106.09685)
      - 凍結原本的預訓練模型，並搭配一個小的模型去微調就可以達到不錯的效果，就像 Adaptor 一樣
      - 可以將 LoRA 視為一個插件，在特定層插入該模組，讓整個模型可以適應對應問題的處理 
    - 嵌入(Embedding)
      - [An Image is Worth One Word: Personalizing Text-to-Image Generation using Textual Inversion](https://arxiv.org/abs/2208.01618) 
    - Hypernetwork ==> using a small network(called a “hypernetwork") to generate the weights for a larger network (called a main network).
      - 2021 [Learning Transferable Visual Models From Natural Language Supervision](https://arxiv.org/abs/2103.00020v1)
      - [Personalizing Text-to-Image Diffusion Models by Fine-Tuning Classification for AI Applications](https://www.researchgate.net/publication/369476053_Personalizing_Text-to-Image_Diffusion_Models_by_Fine-Tuning_Classification_for_AI_Applications) 
    - DreamBooth(2022)
      - [DreamBooth: Fine Tuning Text-to-Image Diffusion Models for Subject-Driven Generation](https://arxiv.org/abs/2208.12242)
      - https://ithelp.ithome.com.tw/articles/10333641
  - REVIEWs:
    - 👍202209 [Diffusion Models: A Comprehensive Survey of Methods and Applications](https://arxiv.org/abs/2209.00796)
    - [[2303.07909] Text-to-image Diffusion Models in Generative AI: A Survey](https://arxiv.org/abs/2303.07909)
    - [Diffusion Models on the Edge: Challenges, Optimizations, and Applications](https://arxiv.org/abs/2504.15298)
      - TABLE II:Key Evaluation Metrics for Edge-Deployed Diffusion Models 
- 範例程式 
  - MNIST dataset  ==> DDPM  https://github.com/bot66/MNISTDiffusion/tree/main
  - DDPM  ==> 【Keras範例程式】[Denoising Diffusion Probabilistic Model](https://keras.io/examples/generative/ddpm/)
    - 本範例要用keras 2, 因為使用別人的權重(在keras2上開發的) 
  - DDIM  ==> 【Keras範例程式】[Denoising Diffusion Implicit Models](https://keras.io/examples/generative/ddim/)
  - Stable Diffusion
    - [Stable Diffusion 3 in KerasHub!](https://keras.io/keras_hub/guides/stable_diffusion_3_in_keras_hub/) [【Keras範例程式解說】](Keras_SD_1.md)
    - [A walk through latent space with Stable Diffusion 3](https://keras.io/examples/generative/random_walks_with_stable_diffusion_3/) [【Keras範例程式解說】](Keras_SD_2.md)
    - [Fine-tuning Stable Diffusion](https://keras.io/examples/generative/finetune_stable_diffusion/) [【Keras範例程式解說】](Keras_SD_3.md)
- 其他主題
  - [Attention in Diffusion Model: A Survey](https://arxiv.org/abs/2504.03738)
  - [A Comprehensive Survey on Knowledge Distillation](https://arxiv.org/abs/2503.12067)
- 應用
  - Anomaly Detection
    - 2025 [ A Survey on Diffusion Models for Anomaly Detection](https://arxiv.org/abs/2501.11430)
  - Image Editing
    - 2025 [Image Editing with Diffusion Models: A Survey]() 
  - Video
    - 2025 [Survey of Video Diffusion Models: Foundations, Implementations, and Applications](https://arxiv.org/abs/2504.16081) 
  - Robotic Manipulation
    - 202504[Diffusion Models for Robotic Manipulation: A Survey](https://arxiv.org/abs/2504.08438)
    - 202503[Generative Artificial Intelligence in Robotic Manipulation: A Survey](https://arxiv.org/abs/2503.03464) 

## [Stable Diffusion 在線](https://stablediffusionweb.com/zh-tw)
### 李弘毅教授YOUTUBE:Diffusion Model
- [【生成式AI】淺談圖像生成模型 Diffusion Model 原理(DDPM)](https://www.youtube.com/watch?v=azBugJzmz-o&list=PLJV_el3uVTsOePyfmkfivYZ7Rqr2nMk3W&index=18)
- [【生成式AI】Stable Diffusion、DALL-E、Imagen 背後共同的套路](https://www.youtube.com/watch?v=JbfcAaBT66U&list=PLJV_el3uVTsOePyfmkfivYZ7Rqr2nMk3W&index=19&t=296s)
- [【生成式AI】Diffusion Model 原理剖析 (1/4) (optional)](https://www.youtube.com/watch?v=ifCDXFdeaaM)
- [【生成式AI】Diffusion Model 原理剖析 (2/4) (optional)](https://www.youtube.com/watch?v=73qwu77ZsTM)
- [【生成式AI】Diffusion Model 原理剖析 (3/4) (optional)](https://www.youtube.com/watch?v=m6QchXTx6wA)
- [【生成式AI】Diffusion Model 原理剖析 (4/4) (optional)](https://www.youtube.com/watch?v=67_M2qP5ssY)
## BOOKS
- [Hands-On Generative AI with Transformers and Diffusion Models](https://learning.oreilly.com/library/view/hands-on-generative-ai/9781098149239/)
- [Using Stable Diffusion with Python](https://learning.oreilly.com/library/view/using-stable-diffusion/9781835086377/)
  - 👍 讚 Chapter 4: Understanding the Theory Behind Diffusion Models 
- [Diffusions in Architecture: Artificial Intelligence and Image Generators](https://learning.oreilly.com/library/view/diffusions-in-architecture/9781394191772/)
- [Applied Generative AI for Beginners: Practical Knowledge on Diffusion Models, ChatGPT, and Other LLMs](https://learning.oreilly.com/library/view/applied-generative-ai/9781484299944/)

## Awesome diffusion
- https://github.com/Zeqiang-Lai/awesome-diffusion
- https://github.com/diff-usion/Awesome-Diffusion-Models

## 延伸學習
- https://github.com/huggingface/diffusion-models-class
  - 中文說明 ==> [擴散模型從原理到實戰](https://www.tenlong.com.tw/products/9787115618870?list_name=srh) 
- 👍CVPR 2022 Tutorial: [Denoising Diffusion-based Generative Modeling:|Foundations and Applications](https://cvpr2022-tutorial-diffusion-models.github.io/)
  - YOUTUBE [Tutorial on Denoising Diffusion-based Generative Modeling: Foundations and Applications](https://www.youtube.com/watch?v=cS6JQpEY9cs)
  - [Diffusion Models: DDPM | Generative AI Animated](https://www.youtube.com/watch?v=EhndHhIvWWw)
- MIT Computer Science Class 6.S184: Generative AI with Stochastic Differential Equations
  - [Introduction to Flow Matching and Diffusion Models](https://diffusion.csail.mit.edu/)
  - [An Introduction to Flow Matching and Diffusion Models](https://arxiv.org/abs/2506.02070) 

## 學習資源
- https://andy6804tw.github.io/wiki/

## review
- [Diffusion Models in Vision: A Survey](https://arxiv.org/abs/2209.04747)
- [Diffusion Models in Recommendation Systems: A Survey](https://arxiv.org/abs/2501.10548)
- [A Survey on Deep Neural Networks in Collaborative Filtering Recommendation Systems](https://arxiv.org/abs/2412.01378)
- [Attacks and Defenses for Generative Diffusion Models: A Comprehensive Survey](https://arxiv.org/abs/2408.03400)
- [A Comprehensive Survey on Knowledge Distillation of Diffusion Models](https://arxiv.org/abs/2304.04262)
- [Survey of Video Diffusion Models: Foundations, Implementations, and Applications](https://arxiv.org/abs/2504.16081)
- [Diffusion Models for Tabular Data: Challenges, Current Progress, and Future Directions](https://arxiv.org/abs/2502.17119)
  - https://github.com/Diffusion-Model-Leiden/awesome-diffusion-models-for-tabular-data 
- [Diffusion Model-Based Image Editing: A Survey](https://arxiv.org/abs/2402.17525)
- [A Survey on Pre-Trained Diffusion Model Distillations](https://arxiv.org/abs/2502.08364)
  - DM 的多步驟樣本生成機制使其在實踐中沒有吸引力，尤其是在資源匱乏的環境中。
  - 與生成對抗網路 （GAN） 等單步生成模型不同Goodfellow 等人。 (2014)，DM 通過反覆運算過程生成樣本，該過程遞歸評估經過訓練的大型神經網路。
  - 這種機制雖然可以有效地產生高質量的輸出，但對於這些高數量的函數計算 （NFE） 會產生大量的計算成本。
  - 此外，訓練實用型 DM 通常需要大量數據，這對訓練過程提出了挑戰。
  - 因此，在效率和速度至關重要的實際應用中部署 DM 仍然是一項重大挑戰。
  - 為了解決這些限制，預先訓練的擴散蒸餾方法作為有前途的解決方案而受到關注。
  - 蒸餾技術旨在創建更小尺寸、更高效的模型，該模型能夠以更少的步驟生成高品質的樣品，從而減少計算開銷。
  - 這些方法的方法差異很大，從損失函數設計到雜訊到樣本生成過程中的軌跡優化。
  - 此review從以下幾個方面系統地研究蒸餾方法：
    - `1`.輸出重建(Output reconstruction) ==> 通過輸出值的角度、輸出分佈、一步去噪像空間和 Fisher 散度來回顧方法。
    - `2`.軌跡蒸餾(Trajectory distillation) ==> 一致性蒸餾(Consistency distillation|Consistency model (CM) )、整流蒸餾(Rectified flow distillation)及其整合(Integrating CM and rectified flow)。
    - `3`.對抗性蒸餾(Adversarial distillation)
  - 最後，此review討論了該領域目前面臨的挑戰，並提出了潛在的未來研究方向。
- 2025[Mean Flows for One-step Generative Modeling](https://arxiv.org/abs/2505.13447)
